<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>使用签到面板自动签到bbs.zsxwz.com</title>
    <url>/2023/08/be08c2cbb62d.html</url>
    <content><![CDATA[<p>保存为 姿势小王子.har ，在签到面板添加模板，填写用户名密码，添加定时任务即可。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;request&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;method&quot;</span><span class="punctuation">:</span><span class="string">&quot;POST&quot;</span><span class="punctuation">,</span><span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com/user-login.htm&quot;</span><span class="punctuation">,</span><span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;User-Agent&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;text/plain, */*; q=0.01&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept-Language&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept-Encoding&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;gzip, deflate, br&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Content-Type&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;application/x-www-form-urlencoded; charset=UTF-8&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;X-Requested-With&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;XMLHttpRequest&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Origin&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Connection&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;keep-alive&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Referer&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com/user-login.htm&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Dest&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;empty&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Mode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;cors&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Site&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;same-origin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Pragma&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;no-cache&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Cache-Control&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;no-cache&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;TE&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;trailers&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;cookies&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="string">&quot;email=&#123;&#123; username |urlencode&#125;&#125;&amp;password=&#123;&#123;md5(password)|urlencode&#125;&#125;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;mimeType&quot;</span><span class="punctuation">:</span><span class="string">&quot;application/x-www-form-urlencoded&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;rule&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;success_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;200&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;status&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;\&quot;code\&quot;: \&quot;0\&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;failed_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;extract_variables&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;message_login&quot;</span><span class="punctuation">,</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;\&quot;message\&quot;: \&quot;(.+)\&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;request&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;method&quot;</span><span class="punctuation">:</span><span class="string">&quot;POST&quot;</span><span class="punctuation">,</span><span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com/sg_sign.htm&quot;</span><span class="punctuation">,</span><span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;User-Agent&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;text/plain, */*; q=0.01&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept-Language&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept-Encoding&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;gzip, deflate, br&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;X-Requested-With&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;XMLHttpRequest&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Origin&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Connection&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;keep-alive&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Referer&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com/sg_sign.htm&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Dest&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;empty&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Mode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;cors&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Site&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;same-origin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Pragma&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;no-cache&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Cache-Control&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;no-cache&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;cookies&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;rule&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;success_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;200&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;status&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;\&quot;code\&quot;: \&quot;0\&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;failed_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;extract_variables&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;message_sign&quot;</span><span class="punctuation">,</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;\&quot;message\&quot;: \&quot;(.+)\&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;request&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;method&quot;</span><span class="punctuation">:</span><span class="string">&quot;GET&quot;</span><span class="punctuation">,</span><span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com/sg_sign.htm&quot;</span><span class="punctuation">,</span><span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;User-Agent&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept-Language&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Accept-Encoding&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;gzip, deflate, br&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Connection&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;keep-alive&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Referer&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;https://bbs.zsxwz.com/sg_sign.htm&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Upgrade-Insecure-Requests&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;1&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Dest&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;document&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Mode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;navigate&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-Site&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;same-origin&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Sec-Fetch-User&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;?1&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Pragma&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;no-cache&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;Cache-Control&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;no-cache&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;TE&quot;</span><span class="punctuation">,</span><span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="string">&quot;trailers&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;cookies&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;rule&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;success_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;200&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;status&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;failed_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;extract_variables&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;signresult&quot;</span><span class="punctuation">,</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;s1 = (&#x27;.+&#x27;);&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;usercount&quot;</span><span class="punctuation">,</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;s2 = (&#x27;.+&#x27;);&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;signdays&quot;</span><span class="punctuation">,</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;s3 = (&#x27;.+&#x27;);&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;comment&quot;</span><span class="punctuation">:</span><span class="string">&quot;生成日志&quot;</span><span class="punctuation">,</span><span class="attr">&quot;request&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;method&quot;</span><span class="punctuation">:</span><span class="string">&quot;POST&quot;</span><span class="punctuation">,</span><span class="attr">&quot;url&quot;</span><span class="punctuation">:</span><span class="string">&quot;api://util/urldecode&quot;</span><span class="punctuation">,</span><span class="attr">&quot;headers&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;cookies&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span><span class="string">&quot;content=登录结果: &#123;&#123;message_login&#125;&#125; , 本次签到结果: &#123;&#123;message_sign&#125;&#125;，连续签到天数:&#123;&#123;signdays&#125;&#125;，当日签到结果:&#123;&#123;signresult&#125;&#125;，站点用户人数:&#123;&#123;usercount&#125;&#125;&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="attr">&quot;rule&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span><span class="attr">&quot;success_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;200&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;status&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span><span class="punctuation">&#123;</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;\&quot;状态\&quot;: \&quot;200\&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;failed_asserts&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="attr">&quot;extract_variables&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;__log__&quot;</span><span class="punctuation">,</span><span class="attr">&quot;re&quot;</span><span class="punctuation">:</span><span class="string">&quot;\&quot;转换后\&quot;: \&quot;(.*)\&quot;&quot;</span><span class="punctuation">,</span><span class="attr">&quot;from&quot;</span><span class="punctuation">:</span><span class="string">&quot;content&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>羊毛</tag>
      </tags>
  </entry>
  <entry>
    <title>通过docker执行定时任务，关闭h3c nx30pro的ipv6防火墙</title>
    <url>/2023/08/e225cd787955.html</url>
    <content><![CDATA[<p>新买的路由器h3c nx30pro有ipv6防火墙，论坛里说可以通过telnet关闭，但是修改无法持久化保存，每次重启后都会还原。<br>群晖没有telnet,于是使用docker来定时执行脚本。<br>群晖下创建镜像的时候总是没网，所以使用另一台nas下的alpine创建镜像，之后推送到镜像仓库（导出镜像之后手动上传到群晖也可以），再在群晖下部署。</p>
<p>h3c_disableipv6firewall.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line">username=&quot;H3C&quot;</span><br><span class="line">password=&quot;xxxxxx&quot;</span><br><span class="line">ip=&quot;192.168.124.1&quot;</span><br><span class="line">Cmd1=&quot;ip6tables -F;ip6tables -X;ip6tables -P INPUT ACCEPT;ip6tables -P OUTPUT ACCEPT;ip6tables -P FORWARD ACCEPT&quot;</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">Cmd2=<span class="string">&quot;ip6tables -L;date;&quot;</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">start</span></span><br><span class="line">(</span><br><span class="line"> sleep 0.5;</span><br><span class="line"> echo $username;</span><br><span class="line"> sleep 0.5;</span><br><span class="line"> echo $password;</span><br><span class="line"> sleep 0.5;</span><br><span class="line"> echo $Cmd1;</span><br><span class="line"> sleep 5;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$Cmd2</span>;</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> <span class="built_in">sleep</span> 1;</span></span><br><span class="line"> echo exit</span><br><span class="line">)|telnet $ip 99</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">end</span></span><br></pre></td></tr></table></figure>


<p>docker-compose.yml</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">crond:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">        <span class="attr">context:</span> <span class="string">./build/</span></span><br><span class="line">        <span class="attr">dockerfile:</span> <span class="string">Dockerfile</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">crond</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;./data:/data/data&#x27;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">&#x27;./log:/var/log&#x27;</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Dockerfile</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="string">FROM</span> <span class="string">alpine:3.18</span></span><br><span class="line"></span><br><span class="line"><span class="string">RUN</span> <span class="string">sed</span> <span class="string">-i</span> <span class="string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g&#x27;</span> <span class="string">/etc/apk/repositories</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">apk</span> <span class="string">add</span> <span class="string">--update</span> <span class="string">--no-cache</span> <span class="string">busybox-extras</span> <span class="string">tzdata</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">cp</span> <span class="string">/usr/share/zoneinfo/Asia/Shanghai</span> <span class="string">/etc/localtime</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">echo</span> <span class="string">&quot;Asia/Shanghai&quot;</span> <span class="string">&gt;</span>  <span class="string">/etc/timezone</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">RUN</span> <span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/data/data/</span></span><br><span class="line"></span><br><span class="line"><span class="string">ADD</span> <span class="string">crontab.txt</span> <span class="string">/data/data/crontab.txt</span></span><br><span class="line"><span class="string">ADD</span> <span class="string">entry.sh</span> <span class="string">/data/entry.sh</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">ENV</span> <span class="string">SUPERCRONIC_URL=https://ghproxy.com/github.com/aptible/supercronic/releases/download/v0.2.26/supercronic-linux-amd64</span> <span class="string">\</span></span><br><span class="line">    <span class="string">SUPERCRONIC=supercronic-linux-amd64</span> <span class="string">\</span></span><br><span class="line">    <span class="string">SUPERCRONIC_SHA1SUM=7a79496cf8ad899b99a719355d4db27422396735</span></span><br><span class="line">    </span><br><span class="line"><span class="string">RUN</span> <span class="string">curl</span> <span class="string">-fsSLO</span> <span class="string">&quot;$SUPERCRONIC_URL&quot;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">echo</span> <span class="string">&quot;$&#123;SUPERCRONIC_SHA1SUM&#125;  $&#123;SUPERCRONIC&#125;&quot;</span> <span class="string">|</span> <span class="string">sha1sum</span> <span class="string">-c</span> <span class="bullet">-</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">chmod</span> <span class="string">+x</span> <span class="string">&quot;$SUPERCRONIC&quot;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">mv</span> <span class="string">&quot;$SUPERCRONIC&quot;</span> <span class="string">&quot;/usr/local/bin/$&#123;SUPERCRONIC&#125;&quot;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">ln</span> <span class="string">-s</span> <span class="string">&quot;/usr/local/bin/$&#123;SUPERCRONIC&#125;&quot;</span> <span class="string">/usr/local/bin/supercronic</span></span><br><span class="line"></span><br><span class="line"><span class="string">COPY</span> <span class="string">supercronic-linux-amd64</span> <span class="string">/usr/local/bin/supercronic</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">chmod</span> <span class="string">+x</span> <span class="string">/usr/local/bin/supercronic</span></span><br><span class="line"><span class="string">ENTRYPOINT</span> [<span class="string">&quot;/bin/ash&quot;</span>, <span class="string">&quot;/data/entry.sh&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>entry.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/sh</span></span><br><span class="line"></span><br><span class="line">[ -f /data/data/crontab.txt ] || touch /data/data/crontab.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">start cron</span></span><br><span class="line">/usr/local/bin/supercronic /data/data/crontab.txt</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p> crontab.txt</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">* * * * * bash /data/h3c_disableipv6firewall.sh   &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将Dockerfile，entry.sh，crontab.txt放到与docker-compose.yml同级的build目录下，执行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker-compose up -d --build</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>synology</tag>
      </tags>
  </entry>
  <entry>
    <title>在一个linux下配置多个ssh私钥</title>
    <url>/2023/08/0dcad8ef81ca.html</url>
    <content><![CDATA[<p>编辑~&#x2F;.ssh&#x2F;config文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 账号A</span><br><span class="line">Host codeup_1</span><br><span class="line">HostName codeup.aliyun.com</span><br><span class="line">IdentityFile ~/.ssh/codeup_1</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityAgent none</span><br><span class="line">IdentitiesOnly yes</span><br><span class="line"></span><br><span class="line"># 账号B</span><br><span class="line">Host codeup_2</span><br><span class="line">HostName codeup.aliyun.com</span><br><span class="line">IdentityFile ~/.ssh/codeup_2</span><br><span class="line">PreferredAuthentications publickey</span><br><span class="line">IdentityAgent none</span><br><span class="line">IdentitiesOnly yes</span><br></pre></td></tr></table></figure>

<ul>
<li>HostName：填写托管平台服务地址；</li>
<li>Host：填写别名，方便命令行使用；</li>
<li>IdentityFile：填写证书位置；</li>
</ul>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
  </entry>
  <entry>
    <title>6位纯数字xyz域名，0.67美元一年</title>
    <url>/2023/08/e4242cc3a973.html</url>
    <content><![CDATA[<p>购买链接：<a href="https://spaceship.com/">https://spaceship.com</a><br>0.67美元一年，续费也是0.67美元<br>6位纯数字xyz域名，用paypal付款使用银行汇率实付人民币4.82，可以手动续费十年的样子。</p>
]]></content>
      <categories>
        <category>other</category>
      </categories>
      <tags>
        <tag>vps</tag>
        <tag>nas</tag>
        <tag>domain</tag>
      </tags>
  </entry>
  <entry>
    <title>使用 briefcase 将python脚本运行在安卓上，并开发用户界面</title>
    <url>/2023/05/8eeae626bab5.html</url>
    <content><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><strong>Kivy 和 BeeWare 都宣称「一次编写，处处部署」，基于这些个框架编写的图形界面程序，都能够打包为全平台的应用程序，比如：Windows、Linux、macOS、Android、IOS。</strong></p>
<h1 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h1><h2 id="1、-环境配置"><a href="#1、-环境配置" class="headerlink" title="1、 环境配置"></a>1、 环境配置</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mkdir beeware</span><br><span class="line">cd beeware</span><br><span class="line">python3 -m venv beeware-venv</span><br><span class="line">source beeware-venv/bin/activate</span><br><span class="line"></span><br><span class="line">pip3 install briefcase</span><br><span class="line">briefcase new projectame</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>在本地先测试运行一下</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd projectame</span><br><span class="line">briefcase dev</span><br></pre></td></tr></table></figure>

<h2 id="2、修改代码以适配briefcase"><a href="#2、修改代码以适配briefcase" class="headerlink" title="2、修改代码以适配briefcase"></a>2、修改代码以适配briefcase</h2><p>具体代码暂时不放了</p>
<p>使用到的python库需要在projectname&#x2F;pyproject.toml中添加，例如</p>
<figure class="highlight toml"><table><tr><td class="code"><pre><span class="line"><span class="attr">requires</span> = [</span><br><span class="line">    <span class="string">&quot;requests==2.30.0&quot;</span>,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h2 id="3、编译安卓版"><a href="#3、编译安卓版" class="headerlink" title="3、编译安卓版"></a>3、编译安卓版</h2><h3 id="3-1-创建安卓脚手架"><a href="#3-1-创建安卓脚手架" class="headerlink" title="3.1 创建安卓脚手架"></a>3.1 创建安卓脚手架</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">briefcase create android</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>选择toga实现用户界面</p>
<h3 id="3-2-构建安卓应用"><a href="#3-2-构建安卓应用" class="headerlink" title="3.2 构建安卓应用"></a>3.2 构建安卓应用</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">briefcase build android</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>maven构建失败时改源，修改projectame&#x2F;build&#x2F;hdtxzs&#x2F;android&#x2F;gradle&#x2F;build.gradle文件，<br>参考<a href="https://blog.csdn.net/a772304419/article/details/115112792">https://blog.csdn.net/a772304419/article/details/115112792</a></p>
<p>pip包安装失败时修改源，修改projectame&#x2F;build&#x2F;hdtxzs&#x2F;android&#x2F;gradle&#x2F;app&#x2F;build.gradle 文件，<br>添加 </p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">options <span class="string">&quot;-i&quot;</span>,<span class="string">&quot;https://pypi.tuna.tsinghua.edu.cn/simple/&quot;</span> <span class="comment">//设置下载镜像</span></span><br></pre></td></tr></table></figure>
<p>修改后如下</p>
<figure class="highlight groovy"><table><tr><td class="code"><pre><span class="line">python &#123;</span><br><span class="line">    version <span class="string">&quot;3.11&quot;</span></span><br><span class="line">    pip &#123;</span><br><span class="line">        options <span class="string">&quot;-i&quot;</span>,<span class="string">&quot;https://pypi.tuna.tsinghua.edu.cn/simple/&quot;</span> <span class="comment">//设置下载镜像</span></span><br><span class="line">        install <span class="string">&quot;-r&quot;</span>, <span class="string">&quot;requirements.txt&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    extractPackages <span class="string">&quot;tests&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-3-运行一下构建好的安卓应用"><a href="#3-3-运行一下构建好的安卓应用" class="headerlink" title="3.3 运行一下构建好的安卓应用"></a>3.3 运行一下构建好的安卓应用</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">briefcase run android</span><br></pre></td></tr></table></figure>

<h3 id="3-4-打包安卓应用"><a href="#3-4-打包安卓应用" class="headerlink" title="3.4 打包安卓应用"></a>3.4 打包安卓应用</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">briefcase package android</span><br></pre></td></tr></table></figure>

<p>3.5 修改代码后编译安卓版需要briefcase update进行更新，使用briefcase dev调试时则不需要</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">briefcase update android -r --update-resources;</span><br></pre></td></tr></table></figure>



<h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p><strong>写东西应该先明确需求再动手</strong></p>
<p>刚开始接的时候需求也不复杂，就是某个商城类软件没有新订单通知，不会自动刷新订单，需要整一个新订单通知。<br>通过httpcanary抓包找到了店主端的订单列表接口，那么只要定时访问这个接口，发现新订单后推送到微信就行。<br>计划使用python编写，cookie什么的写死在脚本中，在终端直接输出信息，写好了再通过docker镜像运行在nas上。<br>在花了点时间完成了脚本编写以及dockerfile的编写后，这时候感觉还可以，功能也不复杂。<br>docker运行了几天后需求有变动，需要一个能在安卓运行的，用java重新整一个又觉得麻烦，就查了下python开发安卓软件的，发现了briefcase，遂选择用briefcase将脚本打包为apk，使用toga提供图形界面，又改了改，装环境就搞了一天。<br>既然有了图形界面，得有个登录吧，这样好更新cookie，又改了改。<br>登录有了，现在运行在手机上了，那就不走微信的通知了，来新订单直接响铃就好了，又改了改。<br>现在就有点屎山代码的味道了，很乱。</p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://www.zhihu.com/tardis/zm/art/385585734?source_id=1003</span><br><span class="line">https://docs.beeware.org/en/latest/</span><br><span class="line">https://stackoverflow.com/questions/74120614/how-to-play-sound-in-an-android-app-created-by-beeware-using-python</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Coding</category>
      </categories>
      <tags>
        <tag>android</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>java 计算器</title>
    <url>/2023/05/14da702bb272.html</url>
    <content><![CDATA[<p>Control.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> FirstCalculator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.awt.BorderLayout;</span><br><span class="line"><span class="keyword">import</span> java.awt.Color;</span><br><span class="line"><span class="keyword">import</span> java.awt.GridLayout;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.MouseMotionAdapter;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.JButton;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JFrame;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JMenu;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JMenuBar;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JMenuItem;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JOptionPane;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JPanel;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JTextArea;</span><br><span class="line"><span class="comment">//import javax.swing.textarea;</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JToolBar;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Control</span> &#123;</span><br><span class="line">	<span class="comment">//用于判断是否重新开始</span></span><br><span class="line">	<span class="type">boolean</span> <span class="variable">start</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">	<span class="type">boolean</span> <span class="variable">panel2stats</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="type">double</span> <span class="variable">result</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">//存放加减乘除等于等</span></span><br><span class="line">	<span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> <span class="string">&quot;=&quot;</span>;</span><br><span class="line">	JTextArea textarea;</span><br><span class="line"><span class="comment">//	JPanel panel1, panel2;</span></span><br><span class="line">	<span class="type">JPanel</span> <span class="variable">panel1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line">	<span class="type">JPanel</span> <span class="variable">panel2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line">	<span class="type">JPanel</span> <span class="variable">panel3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JPanel</span>();</span><br><span class="line">	JFrame jf;</span><br><span class="line">	JButton[] btns1;</span><br><span class="line">	JButton[] btns2;     <span class="comment">//计算器的除C以外的按钮  </span></span><br><span class="line">	</span><br><span class="line">    <span class="type">int</span> x, y;			<span class="comment">//窗口坐标变量</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//鼠标移动时移动窗口</span></span><br><span class="line">	MouseMotionAdapter mouseListener=<span class="keyword">new</span> <span class="title class_">MouseMotionAdapter</span>()</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">mouseDragged</span><span class="params">(MouseEvent e)</span> &#123;</span><br><span class="line">        	</span><br><span class="line"><span class="comment">//            System.out.println(&quot;鼠标拖动&quot;);</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> jf.getLocation().x;</span><br><span class="line">            <span class="type">int</span> <span class="variable">top</span> <span class="operator">=</span> jf.getLocation().y;</span><br><span class="line">            jf.setLocation(left + e.getX() - x, top + e.getY() - y);</span><br><span class="line">        &#125;</span><br><span class="line">	&#125;; </span><br><span class="line">	</span><br><span class="line">	<span class="comment">//去掉小数点后没用的0</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getPrettyNumber</span><span class="params">(String number)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BigDecimal.valueOf(Double.parseDouble(number))</span><br><span class="line">                .stripTrailingZeros().toPlainString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//用循环计算阶乘</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">factorial</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">    	<span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>;i &lt;= num; i++)&#123;</span><br><span class="line">            sum *= i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置拓展面板</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">panel2Visible</span><span class="params">()</span> &#123;</span><br><span class="line">    	panel2stats = <span class="literal">true</span>;</span><br><span class="line">    	panel2.setVisible(<span class="literal">true</span>);</span><br><span class="line">       	jf.setSize(<span class="number">545</span>, <span class="number">400</span>);  </span><br><span class="line"><span class="comment">//    	jf.setVisible(false);</span></span><br><span class="line"><span class="comment">//    	jf.setVisible(true);</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">panel2DisVisible</span><span class="params">()</span> &#123;</span><br><span class="line">    	panel2stats = <span class="literal">false</span>;</span><br><span class="line">        jf.repaint();</span><br><span class="line"><span class="comment">//        jf.pack();</span></span><br><span class="line">        panel2.setVisible(<span class="literal">false</span>);</span><br><span class="line">       	jf.setSize(<span class="number">253</span>, <span class="number">400</span>);  </span><br><span class="line"><span class="comment">//    	jf.setVisible(false);</span></span><br><span class="line"><span class="comment">//    	jf.setVisible(true);</span></span><br><span class="line">       	jf.invalidate();</span><br><span class="line">       	jf.validate();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//用内部类实现事件监听器，计算功能的实现</span></span><br><span class="line">    ActionListener buttonsListener=<span class="keyword">new</span> <span class="title class_">ActionListener</span>()   <span class="comment">//初始化对象，继承ActionListener子类</span></span><br><span class="line">    &#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">actionPerformed</span><span class="params">(ActionEvent e)</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">String</span> <span class="variable">input</span> <span class="operator">=</span> e.getActionCommand();</span><br><span class="line">			<span class="comment">//实现拓展面板的打开和关闭</span></span><br><span class="line">			<span class="keyword">if</span> (input.equals(<span class="string">&quot;&gt;&gt;&quot;</span>)) &#123;</span><br><span class="line">				<span class="keyword">if</span> (panel2stats == <span class="literal">false</span>) &#123;</span><br><span class="line">					panel2Visible();</span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					panel2DisVisible();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span> (input.equals(<span class="string">&quot;Exit&quot;</span>)) &#123;</span><br><span class="line">				System.exit(<span class="number">0</span>); </span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(input.equals(<span class="string">&quot;C&quot;</span>)) &#123;</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//按钮触发事件，进行计算功能，按钮每点击一次，程序都会从此开始</span></span><br><span class="line">			<span class="keyword">if</span>(start) &#123;          		<span class="comment">//程序开始，使输入内容为数字，pi，c </span></span><br><span class="line">				                        <span class="comment">//每一次点击按钮，都会返回开始执行</span></span><br><span class="line">				start = <span class="literal">false</span>;			</span><br><span class="line">				<span class="keyword">if</span>((<span class="type">int</span>)input.charAt(<span class="number">0</span>)&gt;=<span class="number">48</span> &amp;&amp; (<span class="type">int</span>)input.charAt(<span class="number">0</span>)&lt;=<span class="number">57</span></span><br><span class="line">						&amp;&amp; input.length() == <span class="number">1</span> ) &#123;</span><br><span class="line">					textarea.setText(<span class="string">&quot;&quot;</span>+input);       <span class="comment">//将textarea对象的现实内容设置为&quot;&quot;</span></span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(input.equals(<span class="string">&quot;+/-&quot;</span>)) &#123;</span><br><span class="line">					textarea.setText(<span class="string">&quot;-&quot;</span>);				</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(input.equals(<span class="string">&quot;PI&quot;</span>)) &#123;</span><br><span class="line">					textarea.setText(<span class="string">&quot;&quot;</span>+Math.PI);</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">if</span>(input.equals(<span class="string">&quot;C&quot;</span>)) &#123;</span><br><span class="line">					textarea.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125; </span><br><span class="line">			<span class="comment">//0~9数字等非运算符，连接字符串		</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>((<span class="type">int</span>)input.charAt(<span class="number">0</span>)&gt;=<span class="number">48</span> &amp;&amp; (<span class="type">int</span>)input.charAt(<span class="number">0</span>)&lt;=<span class="number">57</span></span><br><span class="line">					&amp;&amp; input.length() == <span class="number">1</span> || input.equals(<span class="string">&quot;.&quot;</span>))&#123;</span><br><span class="line">				textarea.setText(textarea.getText()+input);     <span class="comment">//数字字符进行连接</span></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现所有 数组+运算符 的运算 </span></span><br><span class="line">			<span class="comment">//实现清零键</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;C&quot;</span>))</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>);   <span class="comment">//将文本框置空</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//实现退格键</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;Back&quot;</span>)) &#123;</span><br><span class="line">				<span class="keyword">if</span>(textarea.getText().length() &gt; <span class="number">0</span>)&#123;</span><br><span class="line">					textarea.setText(textarea.getText().substring(<span class="number">0</span>,textarea.getText().length()-<span class="number">1</span>));</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;		</span><br><span class="line">			<span class="comment">//实现正弦三角函数</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;sin&quot;</span>)) &#123;</span><br><span class="line">				result = Math.sin(Double.parseDouble(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现余弦三角函数</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;cos&quot;</span>)) &#123;</span><br><span class="line">				result = Math.cos(Double.parseDouble(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现余切三角函数</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;cot&quot;</span>)) &#123;</span><br><span class="line">				result = <span class="number">1.0</span>/Math.tan(Double.parseDouble(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现正切三角函数</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;tan&quot;</span>)) &#123;</span><br><span class="line">				result = Math.tan(Double.parseDouble(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现十进制到二进制的转化</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;2进制&quot;</span>)) &#123;</span><br><span class="line">				<span class="type">String</span> <span class="variable">result2</span> <span class="operator">=</span> Integer.toBinaryString(Integer.parseInt(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(result2));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现二进制到十进制的转化</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;10进制&quot;</span>)) &#123;</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					<span class="type">String</span> <span class="variable">result2</span> <span class="operator">=</span> Integer.valueOf(textarea.getText(),<span class="number">2</span>).toString();</span><br><span class="line">					textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(result2));</span><br><span class="line">				&#125;<span class="keyword">catch</span>(NumberFormatException exception) &#123;</span><br><span class="line">					JOptionPane.showMessageDialog(<span class="literal">null</span>, <span class="string">&quot;对不起，数字错误，请重新输入！&quot;</span>, <span class="string">&quot;Error!&quot;</span>, JOptionPane.ERROR_MESSAGE);</span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NumberFormatException</span>(<span class="string">&quot;数字格式错误&quot;</span>);</span><br><span class="line">				&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">					start = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现1/x</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;1/X&quot;</span>)) &#123;</span><br><span class="line">				result = <span class="number">1</span> / Double.parseDouble(textarea.getText());</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现平方计算</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;X^2&quot;</span>)) &#123;</span><br><span class="line">				result = Math.pow(Double.parseDouble(textarea.getText()), <span class="number">2</span>);</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现立方计算</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;X^3&quot;</span>)) &#123;</span><br><span class="line">				result = Math.pow(Double.parseDouble(textarea.getText()), <span class="number">3</span>);</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现阶乘 </span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;X!&quot;</span>)) &#123;</span><br><span class="line">				<span class="keyword">if</span>(Double.parseDouble(textarea.getText()) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">					JOptionPane.showMessageDialog(<span class="literal">null</span>, <span class="string">&quot;对不起，阶乘计算不能为负数&quot;</span>, <span class="string">&quot;Error!&quot;</span>, JOptionPane.ERROR_MESSAGE);</span><br><span class="line">					textarea.setText(<span class="string">&quot;对不起，阶乘计算不能为负数&quot;</span>);</span><br><span class="line">					start = <span class="literal">true</span>;</span><br><span class="line">					<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;阶乘计算出现负数&quot;</span>);</span><br><span class="line">				&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">					<span class="type">int</span> sum;</span><br><span class="line">					sum = factorial(Integer.parseInt(textarea.getText()));</span><br><span class="line">					textarea.setText(Integer.toString(sum));</span><br><span class="line">					start = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line"></span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现百分号计算</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;%&quot;</span>)) &#123;</span><br><span class="line">				result = Double.parseDouble(textarea.getText())/ <span class="number">100.0</span>;</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;	</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现开平方根</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;√X&quot;</span>)) &#123;</span><br><span class="line">				result = Math.sqrt(Double.parseDouble(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现开立方根</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;3^√X&quot;</span>)) &#123;</span><br><span class="line">				result = Math.pow(Double.parseDouble(textarea.getText()),<span class="number">1.0</span>/<span class="number">3</span>);</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现获取当前时间</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;time&quot;</span>)) &#123;</span><br><span class="line">				<span class="type">SimpleDateFormat</span> <span class="variable">df</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">				textarea.setText(df.format(System.currentTimeMillis()));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现十进制到八进制的转化</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;8进制&quot;</span>)) &#123;</span><br><span class="line">				<span class="type">String</span> <span class="variable">result2</span> <span class="operator">=</span> Integer.toOctalString(Integer.parseInt(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(result2));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">//实现十进制到16进制的转化</span></span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span>(input.equals(<span class="string">&quot;16进制&quot;</span>)) &#123;</span><br><span class="line">				<span class="type">String</span> <span class="variable">result2</span> <span class="operator">=</span> Integer.toHexString(Integer.parseInt(textarea.getText()));</span><br><span class="line">				textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(result2));</span><br><span class="line">				start = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line">			<span class="comment">//实现加减乘除等 数字+运算符+数字 形式的运算</span></span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">if</span>(!start) &#123;       <span class="comment">//start=false,执行</span></span><br><span class="line">					</span><br><span class="line">					<span class="keyword">if</span>(command.equals(<span class="string">&quot;+&quot;</span>))</span><br><span class="line">					&#123;</span><br><span class="line">						result += Double.parseDouble(textarea.getText());</span><br><span class="line">						start = <span class="literal">true</span>;</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(command.equals(<span class="string">&quot;-&quot;</span>))</span><br><span class="line">						result -= Double.parseDouble(textarea.getText());</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(command.equals(<span class="string">&quot;*&quot;</span>))</span><br><span class="line">						result *= Double.parseDouble(textarea.getText());</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(command.equals(<span class="string">&quot;/&quot;</span>)) &#123;</span><br><span class="line">						<span class="keyword">if</span>(Double.parseDouble(textarea.getText()) != <span class="number">0</span>) &#123;</span><br><span class="line">							result /= Double.parseDouble(textarea.getText());</span><br><span class="line">							&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">								textarea.setText(<span class="string">&quot;&quot;</span>+<span class="string">&quot;对不起，除数不能为零&quot;</span>);</span><br><span class="line">								JOptionPane.showMessageDialog(<span class="literal">null</span>, <span class="string">&quot;对不起，除数不能为零&quot;</span>, <span class="string">&quot;Error!&quot;</span>, JOptionPane.ERROR_MESSAGE);</span><br><span class="line">								command = <span class="string">&quot;=&quot;</span>;</span><br><span class="line">								start = <span class="literal">true</span>;</span><br><span class="line">								<span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">ArithmeticException</span>(<span class="string">&quot;除数为零&quot;</span>);</span><br><span class="line">							&#125;</span><br><span class="line">						</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(command.equals(<span class="string">&quot;=&quot;</span>)) &#123;</span><br><span class="line">						result = Double.parseDouble(textarea.getText());</span><br><span class="line">					&#125;</span><br><span class="line">					<span class="keyword">else</span> <span class="keyword">if</span>(command.equals(<span class="string">&quot;X^y&quot;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">						result = Math.pow(result, Double.parseDouble(textarea.getText()));</span><br><span class="line">					&#125;</span><br><span class="line">					textarea.setText(<span class="string">&quot;&quot;</span>+getPrettyNumber(Double.toString(result)));</span><br><span class="line">					command = input;</span><br><span class="line">					start = <span class="literal">true</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>MyCalculator.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> FirstCalculator;</span><br><span class="line"><span class="keyword">import</span> java.awt.BorderLayout;</span><br><span class="line"><span class="keyword">import</span> java.awt.Color;   <span class="comment">//Color是用来封装颜色的，支持多种颜色空间，默认为RGB颜色空间</span></span><br><span class="line"><span class="keyword">import</span> java.awt.FlowLayout;</span><br><span class="line"><span class="keyword">import</span> java.awt.Font;</span><br><span class="line"><span class="keyword">import</span> java.awt.GridLayout;  <span class="comment">//使用指定的行数、列数，以及默认的横向间距、纵向间距将容器分割成多个网格。</span></span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;  <span class="comment">//</span></span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;  <span class="comment">// 为了能监视到ActionEvent类型的事件，事件源必须使用</span></span><br><span class="line">									  <span class="comment">//addActionListener方法获得监视器，创建监视器的类必须实现接口ActionListener</span></span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="comment">//BigDecimal类是不可变的、任意精度的有符号十进制数对象。（精度一般指的都是小数点后面的位数）</span></span><br><span class="line"><span class="comment">//BigDecimal由任意精度的整数非标度值 和 32 位的整数标度 (scale) 组成。(可以看他的valueof（）方法)</span></span><br><span class="line"><span class="comment">//如果为零或正数，则标度是小数点后的位数。如果为负数，则将该数的非标度值乘以 10 的负 scale 次幂。</span></span><br><span class="line"><span class="comment">//BigDecimal提供以下操作：算术、标度操作、舍入、比较、哈希算法和格式转换。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;  <span class="comment">//允许以为日期-时间格式化选择任何用户指定的方式启动。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.swing.BorderFactory;</span><br><span class="line"><span class="comment">//swing为布局管理器</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JButton;  <span class="comment">//JButton 类的实例。用于创建按钮类似实例中的 &quot;Login&quot;。</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JFrame;  <span class="comment">// java的GUI程序的基本思路是以JFrame为基础，它是屏幕上window的对象，能够最大化、最小化、关闭。</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JOptionPane; <span class="comment">//息框引入它之后你就可以编写弹出消息框的代码了</span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JPanel;  <span class="comment">// Java图形用户界面(GUI)工具包swing中的面板容器类，包含在javax.swing 包中，可以进行嵌套，</span></span><br><span class="line">						   <span class="comment">//功能是对窗体中具有相同逻辑功能的组件进行组合，是一种轻量级容器，可以加入到JFrame窗体中。</span></span><br><span class="line"><span class="comment">//import javax.swing.textarea;    //一个轻量级组件，它允许编辑单行文本。 </span></span><br><span class="line"><span class="keyword">import</span> javax.swing.JMenu;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JMenuBar;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JMenuItem;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JTextArea;</span><br><span class="line"><span class="keyword">import</span> javax.swing.JToolBar;</span><br><span class="line"></span><br><span class="line"><span class="comment">//MyCalculator类定义界面属性</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyCalculator</span> <span class="keyword">extends</span> <span class="title class_">Control</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//用构造方法进行必要的设置，设置界面名称，大小。</span></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">MyCalculator</span><span class="params">()</span> &#123;</span><br><span class="line">		jf = <span class="keyword">new</span> <span class="title class_">JFrame</span>(<span class="string">&quot;计算器&quot;</span>);</span><br><span class="line"><span class="comment">//		jf.setTitle(&quot;科学计算器&quot;);         //设置标题</span></span><br><span class="line">		</span><br><span class="line">		jf.setSize(<span class="number">250</span>, <span class="number">400</span>);               <span class="comment">//设置界面大小</span></span><br><span class="line"><span class="comment">//		jf.pack();</span></span><br><span class="line">		jf.setLocationRelativeTo(<span class="literal">null</span>);</span><br><span class="line">		<span class="comment">//设置菜单栏</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//添加文本域</span></span><br><span class="line">		textarea = <span class="keyword">new</span> <span class="title class_">JTextArea</span>(<span class="number">1</span>,<span class="number">10</span>);</span><br><span class="line">		textarea.setOpaque(<span class="literal">false</span>);       <span class="comment">//设置文本框不透明</span></span><br><span class="line">	    textarea.setEditable(<span class="literal">true</span>);      <span class="comment">//使调用这个函数的控件不能被编辑，如果设为true或者不调用这个函数，则控件可以编辑</span></span><br><span class="line">	    								 <span class="comment">//setselected(false)是设置选项不可用。</span></span><br><span class="line">	    panel3.add(textarea); </span><br><span class="line">	    panel3.setBackground(Color.black); </span><br><span class="line">		jf.add(panel3,BorderLayout.NORTH);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//添加主界面按钮</span></span><br><span class="line">		panel1.setLayout(<span class="keyword">new</span> <span class="title class_">GridLayout</span>(<span class="number">5</span>,<span class="number">4</span>,<span class="number">0</span>,<span class="number">0</span>));</span><br><span class="line">		String name[] = &#123;</span><br><span class="line">				</span><br><span class="line">				<span class="string">&quot;C&quot;</span>,<span class="string">&quot;/&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;Exit&quot;</span>,</span><br><span class="line">				<span class="string">&quot;7&quot;</span>,<span class="string">&quot;8&quot;</span>,<span class="string">&quot;9&quot;</span>,<span class="string">&quot;-&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;5&quot;</span>,</span><br><span class="line">				<span class="string">&quot;6&quot;</span>,<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;%&quot;</span>,</span><br><span class="line">				<span class="string">&quot;0&quot;</span>,<span class="string">&quot;.&quot;</span>,<span class="string">&quot;=&quot;</span>,<span class="string">&quot;&gt;&gt;&quot;</span></span><br><span class="line">		&#125;;</span><br><span class="line">		btns1 = <span class="keyword">new</span> <span class="title class_">JButton</span>[name.length];</span><br><span class="line">	</span><br><span class="line">		<span class="comment">//利用循环创建按钮对象并添加事件监听器</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; name.length; i++) &#123;	   </span><br><span class="line">			</span><br><span class="line">			btns1[i] = <span class="keyword">new</span> <span class="title class_">JButton</span>(name[i]);</span><br><span class="line">			btns1[i].addActionListener(buttonsListener);</span><br><span class="line">			btns1[i].setBorderPainted(<span class="literal">false</span>);  </span><br><span class="line">			panel1.add(btns1[i]);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		</span></span><br><span class="line"><span class="comment">//		设置拓展面板</span></span><br><span class="line">    	btns2 = <span class="keyword">new</span> <span class="title class_">JButton</span>[<span class="number">20</span>];</span><br><span class="line">        panel2.setLayout(<span class="keyword">new</span> <span class="title class_">GridLayout</span>(<span class="number">5</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">		String name2[] = &#123;</span><br><span class="line">				</span><br><span class="line">				<span class="string">&quot;+/-&quot;</span>,<span class="string">&quot;PI&quot;</span>,<span class="string">&quot;1/X&quot;</span>,<span class="string">&quot;X^2&quot;</span>,<span class="string">&quot;X^3&quot;</span>,</span><br><span class="line">				<span class="string">&quot;X^y&quot;</span>,<span class="string">&quot;X!&quot;</span>,<span class="string">&quot;√X&quot;</span>,<span class="string">&quot;3^√X&quot;</span>,<span class="string">&quot;sin&quot;</span>,</span><br><span class="line">				<span class="string">&quot;cos&quot;</span>,<span class="string">&quot;tan&quot;</span>,<span class="string">&quot;%&quot;</span>,<span class="string">&quot;2进制&quot;</span>,<span class="string">&quot;10进制&quot;</span>,<span class="string">&quot;Back&quot;</span>,<span class="string">&quot;time&quot;</span>,<span class="string">&quot;8进制&quot;</span>,<span class="string">&quot;16进制&quot;</span>,<span class="string">&quot;d&quot;</span></span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//利用循环创建按钮对象并添加事件监听器，并设置按钮格式</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; name2.length; i++) &#123;	   </span><br><span class="line">			</span><br><span class="line">			btns2[i] = <span class="keyword">new</span> <span class="title class_">JButton</span>(name2[i]);			</span><br><span class="line">			btns2[i].addActionListener(buttonsListener);</span><br><span class="line">			btns2[i].setBorderPainted(<span class="literal">false</span>);</span><br><span class="line">            btns2[i].setBackground(Color.black); </span><br><span class="line">            btns2[i].setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;粗体&quot;</span>, Font.BOLD, <span class="number">12</span>));<span class="comment">// 按钮文本样式</span></span><br><span class="line">            btns2[i].setForeground(Color.white);<span class="comment">// 设置字体颜色</span></span><br><span class="line">			panel2.add(btns2[i]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">		jf.addMouseMotionListener(mouseListener);   <span class="comment">//鼠标运动监听器MouseMotionListener，对于鼠标的移动和拖放进行监控</span></span><br><span class="line">		jf.add(panel1, BorderLayout.WEST);   <span class="comment">//增加面板</span></span><br><span class="line">		jf.add(panel2, BorderLayout.EAST);	 <span class="comment">//对拓展面板位置进行定义</span></span><br><span class="line">        panel2.setVisible(<span class="literal">false</span>);            <span class="comment">//定义面板panel2初始状态为关闭</span></span><br><span class="line">		<span class="built_in">this</span>.setFontAndColor();</span><br><span class="line">		</span><br><span class="line">		jf.setUndecorated(<span class="literal">true</span>);      		<span class="comment">//让Frame窗口失去边框和标题栏的修饰</span></span><br><span class="line">        jf.setOpacity(<span class="number">0.85f</span>);        		<span class="comment">//设置面板透明度</span></span><br><span class="line">        jf.setBackground(Color.black);      <span class="comment">//设置背景颜色</span></span><br><span class="line">		jf.setDefaultCloseOperation(jf.EXIT_ON_CLOSE);      </span><br><span class="line">		jf.setVisible(<span class="literal">true</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//设置字体颜色</span></span><br><span class="line">	<span class="keyword">void</span> <span class="title function_">setFontAndColor</span><span class="params">()</span> &#123; </span><br><span class="line">    	<span class="comment">//修饰窗体</span></span><br><span class="line">        <span class="comment">// 设置字体和颜色  </span></span><br><span class="line">        <span class="comment">// 输出框字体  </span></span><br><span class="line">        <span class="type">Font</span> <span class="variable">f</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;粗体&quot;</span>, Font.BOLD, <span class="number">20</span>);  </span><br><span class="line">        textarea.setFont(f); </span><br><span class="line">        textarea.setForeground(Color.white);	<span class="comment">// 设置字体颜色</span></span><br><span class="line">        textarea.setBackground(Color.black);</span><br><span class="line">        jf.setBackground(Color.black);</span><br><span class="line">        <span class="comment">// 主面板按钮颜色  </span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; btns1.length; i++) &#123;  </span><br><span class="line">            btns1[i].setBackground(Color.black); </span><br><span class="line">            btns1[i].setFont(<span class="keyword">new</span> <span class="title class_">Font</span>(<span class="string">&quot;粗体&quot;</span>, Font.BOLD, <span class="number">16</span>));<span class="comment">// 按钮按钮文本样式</span></span><br><span class="line">            btns1[i].setForeground(Color.white);<span class="comment">// 设置字体颜色</span></span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">//panel背景色的设置</span></span><br><span class="line">        panel1.setBackground(Color.black);      <span class="comment">//主面板背景色</span></span><br><span class="line">        panel2.setBackground(Color.black);      <span class="comment">//拓展面板背景色</span></span><br><span class="line">    &#125;  </span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>Main.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> FirstCalculator;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line"> </span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">MyCalculator</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>Coding</category>
      </categories>
      <tags>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>tomcat+servlet+spring boot的信息管理系统</title>
    <url>/2023/05/22bbd76734a6.html</url>
    <content><![CDATA[<p>待补充</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Coding</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>tomvat</tag>
        <tag>spring</tag>
      </tags>
  </entry>
  <entry>
    <title>基于alpine生成 docker镜像</title>
    <url>/2023/05/44d80c163548.html</url>
    <content><![CDATA[<p>创建Dockerfile文件</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">FROM alpine:3.6</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    ENV PACKAGES=<span class="string">&quot;\</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     dumb-init \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     musl \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     libc6-compat \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     linux-headers \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     build-base \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     bash \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     git \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     ca-certificates \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     freetype \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     libgfortran \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     libgcc \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     libstdc++ \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     openblas \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     tcl \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     tk \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     libssl1.0 \</span></span></span><br><span class="line"><span class="string"><span class="language-bash">#     &quot;</span></span></span><br><span class="line"></span><br><span class="line">ENV PYTHON_PACKAGES=&quot;\</span><br><span class="line">    requests \</span><br><span class="line">    bs4 \</span><br><span class="line">    certifi \</span><br><span class="line">    &quot;</span><br><span class="line"></span><br><span class="line">COPY entrypoint.sh /data/entrypoint.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN apk add --update --no-cache curl jq py3-configobj py3-pip py3-setuptools python3 python3-dev</span></span><br><span class="line">RUN sed -i &#x27;s/dl-cdn.alpinelinux.org/mirrors.ustc.edu.cn/g&#x27; /etc/apk/repositories \</span><br><span class="line">    &amp;&amp; apk add --update --no-cache py3-pip python3 tzdata \</span><br><span class="line">    &amp;&amp; cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \</span><br><span class="line">    &amp;&amp; echo &quot;Shanghai/Asia&quot; &gt; /etc/timezone \</span><br><span class="line">    &amp;&amp; apk del tzdata \</span><br><span class="line">    &amp;&amp; rm -rf /var/cache/apk/* \</span><br><span class="line">    &amp;&amp; ln -s /usr/include/locale.h /usr/include/xlocale.h \</span><br><span class="line">    &amp;&amp; pip3 install --upgrade pip setuptools  -i https://pypi.tuna.tsinghua.edu.cn/simple \</span><br><span class="line">    &amp;&amp; ln -sf /usr/bin/python3 /usr/bin/python \</span><br><span class="line">    &amp;&amp; ln -sf pip3 /usr/bin/pip \</span><br><span class="line">    &amp;&amp; rm -r /root/.cache \</span><br><span class="line">    &amp;&amp; pip install --no-cache-dir $PYTHON_PACKAGES  -i https://pypi.tuna.tsinghua.edu.cn/simple \</span><br><span class="line">    &amp;&amp; chmod +x /data/entrypoint.sh</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">    &amp;&amp; apk add --no-cache --virtual build-dependencies <span class="variable">$PACKAGES</span> \</span></span><br><span class="line"><span class="language-bash"></span><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">set</span> working directory</span></span><br><span class="line">WORKDIR /data</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="comment"># add and install requirements</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">COPY ./requirements.txt /data/requirements.txt <span class="comment"># other than data science packages go here</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">RUN pip install -r requirements.txt</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">add entrypoint.sh</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> ./entrypoint.sh</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">add app</span></span><br><span class="line">COPY app /data/app</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">run server</span></span><br><span class="line">CMD [&quot;sh&quot;,&quot;/data/entrypoint.sh&quot;]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>创建entrypoint.sh</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/ysr/bin/env bash</span></span><br><span class="line">[ -d /var/run  ]||mkdir -p /var/run</span><br><span class="line">[ -f /var/run/lottery.pid  ]||touch /var/run/lottery.pid</span><br><span class="line">kill `cat /var/run/lottery.pid` &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">echo $$ &gt;/var/run/lottery.pid &gt;/dev/null 2&gt;&amp;1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="built_in">date</span></span></span><br><span class="line">cd ./app</span><br><span class="line">python3 python.py                         #python.py就是需要运行的脚本</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>根据Dockerfile创建docker镜像,alpine-yaohuo为镜像名</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker build -f Dockerfile -t &#x27;alpine-yaohuo&#x27; .</span><br></pre></td></tr></table></figure>


<p>创建容器并运行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker stop yaohuo  &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">docker rm yaohuo &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">docker rmi alpine-yaohuo &gt;/dev/null 2&gt;&amp;1</span><br><span class="line">docker build -f Dockerfile -t &#x27;alpine-yaohuo&#x27; .</span><br><span class="line">docker run  -dit --name yaohuo -v /usr/docker/yaohuo:/data alpine-yaohuo</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>参考<br><a href="https://www.liwei.co/posts/14.html">https://www.liwei.co/posts/14.html</a></p>
]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>alpine</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>python 妖火吃肉脚本</title>
    <url>/2023/05/e55600c849a3.html</url>
    <content><![CDATA[<p>忘了哪一年从妖火下载的，这几天用发现失效了，修改了下，登录还没弄账号就异常了，不整了不整了。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># coding:utf8</span></span><br><span class="line"><span class="keyword">import</span> requests, re, random, sqlite3, os, time, datetime, http.client, ssl</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line">logname = <span class="string">&#x27;xxxxxxxxxxxxx&#x27;</span> <span class="comment">#帐号</span></span><br><span class="line">logpass = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxxx&#x27;</span><span class="comment">#密码</span></span><br><span class="line">yaohuo = <span class="string">&#x27;http://yaohuo.me&#x27;</span></span><br><span class="line">counts = <span class="number">3</span> <span class="comment">#爬取最新帖子页数</span></span><br><span class="line">cookie = <span class="literal">None</span></span><br><span class="line">CONTENT = [<span class="string">&#x27;吃&#x27;</span>, <span class="string">&#x27;吃.&#x27;</span>, <span class="string">&#x27;吃..&#x27;</span>, <span class="string">&#x27;吃...&#x27;</span>, <span class="string">&#x27;吃rou&#x27;</span>,<span class="string">&#x27;吃肉.&#x27;</span>, <span class="string">&#x27;吃吃.&#x27;</span>,  <span class="string">&#x27;吃肉&#x27;</span>, <span class="string">&#x27;吃个肉&#x27;</span>, <span class="string">&#x27;吃了&#x27;</span>, <span class="string">&#x27;吃吃&#x27;</span>, <span class="string">&#x27;感谢&#x27;</span>]</span><br><span class="line">errorInterval=<span class="number">0</span></span><br><span class="line">meats=<span class="number">0</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># def login():</span></span><br><span class="line"><span class="comment">#     url = yaohuo + &#x27;/waplogin.aspx&#x27;</span></span><br><span class="line"><span class="comment">#     _data = &#123;&#x27;logname&#x27;: logname,</span></span><br><span class="line"><span class="comment">#              &#x27;logpass&#x27;: logpass,</span></span><br><span class="line"><span class="comment">#              &#x27;action&#x27;: &#x27;login&#x27;,</span></span><br><span class="line"><span class="comment">#              &#x27;classid&#x27;: &#x27;0&#x27;,</span></span><br><span class="line"><span class="comment">#              &#x27;siteid&#x27;: &#x27;1000&#x27;,</span></span><br><span class="line"><span class="comment">#              &#x27;sid&#x27;: &#x27;&#x27;,</span></span><br><span class="line"><span class="comment">#              &#x27;backurl&#x27;: &#x27;wapindex.aspx?sid=-2&#x27;,</span></span><br><span class="line"><span class="comment">#              &#x27;referer&#x27;: &#x27;&#x27;&#125;</span></span><br><span class="line"><span class="comment">#     headers = &#123;</span></span><br><span class="line"><span class="comment">#         &#x27;DNT&#x27;: &#x27;1&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Upgrade-Insecure-Requests&#x27;: &#x27;1&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Sec-Fetch-User&#x27;: &#x27;?1&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Pragma&#x27;: &#x27;no-cache&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Cookie&#x27;: &#x27;ASP.NET_SessionId=aj4ha245f0s3e2bwabasfqnv; GUID=4f157b2221583112&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/113.0&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Accept&#x27;: &#x27;*/*&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Host&#x27;: &#x27;yaohuo.me&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;Connection&#x27;: &#x27;keep-alive&#x27;</span></span><br><span class="line"><span class="comment">#     &#125;</span></span><br><span class="line"><span class="comment">#     r = requests.post(url, data=_data)</span></span><br><span class="line"><span class="comment">#     return requests.utils.dict_from_cookiejar(r.cookies)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认的 HTTPS上下文 使用 不校验的上下文</span></span><br><span class="line">ssl._create_default_https_context = ssl._create_unverified_context</span><br><span class="line"><span class="comment"># netconn = http.client.HTTPSConnection(&quot;yaohuo.me&quot;)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;&#x27;</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;DNT&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Upgrade-Insecure-Requests&#x27;</span>: <span class="string">&#x27;1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Sec-Fetch-User&#x27;</span>: <span class="string">&#x27;?1&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Pragma&#x27;</span>: <span class="string">&#x27;no-cache&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;ASP.NET_SessionId=xxxxxxxxxxxxxxx; GUID=xxxxxxxxxxxxxxxxxxxx; sidyaohuo=xxxxxxxxxxxxxxxxxxxxxxx; sidyaohuo=xxxxxxxxxxxxxxxxxxxxxxxx&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/113.0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;*/*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Host&#x27;</span>: <span class="string">&#x27;yaohuo.me&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Connection&#x27;</span>: <span class="string">&#x27;keep-alive&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_conn</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args,**kargs</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">&#x27;yaohuo.db&#x27;</span>):</span><br><span class="line">            conn = sqlite3.connect(<span class="string">&#x27;yaohuo.db&#x27;</span>)</span><br><span class="line">            cursor = conn.cursor()</span><br><span class="line">            sql = <span class="string">&#x27;&#x27;&#x27;CREATE TABLE yaohuo (</span></span><br><span class="line"><span class="string">                        `id`	INTEGER NOT NULL UNIQUE,</span></span><br><span class="line"><span class="string">                        `classid` INTEGER NOT NULL,</span></span><br><span class="line"><span class="string">                        `url`	TEXT NOT NULL,</span></span><br><span class="line"><span class="string">                        `datetime`	NUMERIC NOT NULL</span></span><br><span class="line"><span class="string">                        );</span></span><br><span class="line"><span class="string">                        &#x27;&#x27;&#x27;</span></span><br><span class="line">            cursor.execute(sql)</span><br><span class="line">            cursor.close()</span><br><span class="line">            conn.commit()</span><br><span class="line">            conn.close()</span><br><span class="line">        conn = sqlite3.connect(<span class="string">&#x27;yaohuo.db&#x27;</span>)</span><br><span class="line">        cursor = conn.cursor()</span><br><span class="line">        result = func(args,cursor)</span><br><span class="line">        cursor.close()</span><br><span class="line">        conn.commit()</span><br><span class="line">        conn.close()</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">return</span> wrapper</span><br><span class="line"></span><br><span class="line"><span class="meta">@sql_conn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_insert</span>(<span class="params">*args</span>):</span><br><span class="line">    cursor = args[<span class="number">1</span>]</span><br><span class="line">    cursor.execute(<span class="string">&#x27;insert into &quot;yaohuo&quot; values (?,?,?,?)&#x27;</span>, (args[<span class="number">0</span>][<span class="number">0</span>], args[<span class="number">0</span>][<span class="number">1</span>], args[<span class="number">0</span>][<span class="number">2</span>], time.time()))</span><br><span class="line"></span><br><span class="line"><span class="meta">@sql_conn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_del</span>(<span class="params">*args</span>):</span><br><span class="line">    cursor = args[<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(args[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">    cursor.execute(<span class="string">&#x27;delete from &quot;yaohuo&quot; where id = ?&#x27;</span>, (args[<span class="number">0</span>][<span class="number">0</span>],))</span><br><span class="line"></span><br><span class="line"><span class="meta">@sql_conn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_traversal</span>(<span class="params">*args</span>):</span><br><span class="line">    cursor = args[<span class="number">1</span>]</span><br><span class="line">    cursor.execute(<span class="string">&#x27;select * from yaohuo&#x27;</span>)</span><br><span class="line">    result = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">@sql_conn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_update</span>(<span class="params">*args</span>):</span><br><span class="line">    cursor = args[<span class="number">1</span>]</span><br><span class="line">    cursor.execute(<span class="string">&#x27;update &quot;yaohuo&quot; set &quot;datetime&quot;=? where id = ?&#x27;</span>, (time.time(), args[<span class="number">0</span>][<span class="number">0</span>]))</span><br><span class="line"></span><br><span class="line"><span class="meta">@sql_conn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_check</span>(<span class="params">*args</span>):</span><br><span class="line">    cursor = args[<span class="number">1</span>]</span><br><span class="line">    cursor.execute(<span class="string">&#x27;select * from yaohuo where id = ?&#x27;</span>, (args[<span class="number">0</span>][<span class="number">0</span>],))</span><br><span class="line">    result = cursor.fetchall()</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">len</span>(result) == <span class="number">0</span> ):</span><br><span class="line">        result=<span class="literal">False</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        result=<span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">@sql_conn</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sql_detailcheck</span>(<span class="params">*args</span>):</span><br><span class="line">    cursor = args[<span class="number">1</span>]</span><br><span class="line">    cursor.execute(<span class="string">&#x27;select * from yaohuo where id = ?&#x27;</span>, (args[<span class="number">0</span>][<span class="number">0</span>],))</span><br><span class="line">    result = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">craw</span>(<span class="params">newurl,netconn</span>):</span><br><span class="line">    netconn.request(<span class="string">&quot;GET&quot;</span>, newurl, payload, headers)</span><br><span class="line">    res = netconn.getresponse()</span><br><span class="line">    page = res.read().decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">    soup = BeautifulSoup(page, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    links = soup.find_all(<span class="string">&#x27;div&#x27;</span>, class_=re.<span class="built_in">compile</span>(<span class="string">r&#x27;line\d&#x27;</span>))</span><br><span class="line">    <span class="keyword">for</span> link <span class="keyword">in</span> links:</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">str</span>(link).find(<span class="string">&#x27;/NetImages/li.gif&#x27;</span>)) != -<span class="number">1</span>:</span><br><span class="line">            url = re.findall(<span class="string">r&#x27;href=&quot;(.*)html&#x27;</span>, <span class="built_in">str</span>(link))[<span class="number">0</span>] + <span class="string">&#x27;html&#x27;</span></span><br><span class="line">            netconn.request(<span class="string">&quot;GET&quot;</span>, url, payload, headers)</span><br><span class="line">            res = netconn.getresponse()</span><br><span class="line">            r = res.read().decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            soup = BeautifulSoup(r, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">            <span class="built_in">id</span> = re.findall(<span class="string">r&#x27;value=&quot;(.*)&quot;&#x27;</span>, <span class="built_in">str</span>(soup.find_all(<span class="string">&#x27;input&#x27;</span>, &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&quot;id&quot;</span>&#125;)))[<span class="number">0</span>]</span><br><span class="line">            classid = re.findall(<span class="string">r&#x27;value=&quot;(.*)&quot;&#x27;</span>, <span class="built_in">str</span>(soup.find_all(<span class="string">&#x27;input&#x27;</span>, &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&quot;classid&quot;</span>&#125;)))[<span class="number">0</span>]</span><br><span class="line">            text = soup.find(<span class="string">&#x27;div&#x27;</span>, class_=re.<span class="built_in">compile</span>(<span class="string">r&#x27;paibi&#x27;</span>)).text      <span class="comment">#网页文本</span></span><br><span class="line">            searchObj = re.search( <span class="string">r&#x27;(余[0-9]&#123;0,&#125;[1-9]&#123;1,&#125;)&#x27;</span>, text, re.M|re.I)</span><br><span class="line">            <span class="keyword">if</span> searchObj:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;不余0：&#x27;</span> + text + <span class="string">&#x27;\n&#x27;</span> + yaohuo+url)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="keyword">if</span> sql_check(<span class="built_in">id</span>):</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;已经吃过:&quot;</span>+yaohuo+url)</span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            a1=sql_detailcheck(<span class="built_in">id</span>)[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line">                            a2=time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>, time.localtime(a1))</span><br><span class="line">                            <span class="built_in">print</span>(a2)</span><br><span class="line">                            a3=time.strftime(<span class="string">&quot;%Y-%m-%d&quot;</span>, time.localtime())</span><br><span class="line">                            <span class="built_in">print</span>(a3)</span><br><span class="line">                            <span class="keyword">if</span> a2 != a3:</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">&quot;再次开吃：&quot;</span>+yaohuo+url)</span><br><span class="line">                                eat(<span class="built_in">id</span>, classid,netconn)</span><br><span class="line">                                sql_update(<span class="built_in">id</span>, classid,url)</span><br><span class="line">                            <span class="keyword">continue</span></span><br><span class="line">                        <span class="keyword">except</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;再次开吃出错:&quot;</span>+yaohuo+url)</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;开吃：&quot;</span>+yaohuo+url)</span><br><span class="line">                        eat(<span class="built_in">id</span>, classid,netconn)</span><br><span class="line">                        sql_insert(<span class="built_in">id</span>, classid,url)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;出错&#x27;</span>)</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;余0:&#x27;</span> + text + <span class="string">&#x27;\n&#x27;</span> + yaohuo+url)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">eat</span>(<span class="params"><span class="built_in">id</span>, classid,netconn</span>):</span><br><span class="line">    <span class="keyword">global</span> meats</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tryeatcount=<span class="number">0</span></span><br><span class="line">        eatObj = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">while</span> (eatObj <span class="keyword">is</span> <span class="literal">None</span>) <span class="keyword">and</span> ( tryeatcount &lt; <span class="number">5</span> ):</span><br><span class="line">            _data = <span class="string">&#x27;face=&amp;sendmsg=0&amp;content=&#x27;</span>+<span class="built_in">str</span>(CONTENT[(random.randint(<span class="number">1</span>, <span class="built_in">len</span>(CONTENT) - <span class="number">1</span>))])+<span class="string">&#x27;&amp;action=add&amp;id=&#x27;</span>+<span class="built_in">id</span>+<span class="string">&#x27;&amp;siteid=1000&amp;lpage=1&amp;classid=&#x27;</span>+classid+<span class="string">&#x27;&amp;sid=07BFF226E0AF500_3C6_03179_21730_21001-2-0-0-0-0&amp;g=%E5%BF%AB%E9%80%9F%E5%9B%9E%E5%A4%8D&#x27;</span></span><br><span class="line">            netconn.request(<span class="string">&quot;POST&quot;</span>, <span class="string">&#x27;/bbs/book_re.aspx&#x27;</span>, _data.encode(<span class="string">&#x27;utf-8&#x27;</span>), headers)</span><br><span class="line">            res = netconn.getresponse()</span><br><span class="line">            r = res.read().decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            eattext= BeautifulSoup(r, <span class="string">&#x27;html.parser&#x27;</span>).text</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&#x27;请不要发重复内容&#x27;</span> <span class="keyword">in</span> eattext):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;请不要发重复内容&#x27;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            eatObj=re.search( <span class="string">r&#x27;(获得妖晶:[0-9]&#123;0,&#125;，获得经验:[0-9]&#123;0,&#125;)&#x27;</span>, eattext, re.M|re.I)</span><br><span class="line">            <span class="built_in">print</span>(eatObj.group())</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                m1=re.search( <span class="string">r&#x27;(获得妖晶:[0-9]&#123;0,&#125;)&#x27;</span>, eattext, re.M|re.I)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    m2=re.search( <span class="string">r&#x27;([0-9]&#123;1,&#125;)&#x27;</span>, <span class="built_in">str</span>(m1.group(<span class="number">1</span>)), re.M|re.I)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;计算吃肉结果失败2&#x27;</span>)</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    meats=meats+<span class="built_in">int</span>(m2.group(<span class="number">1</span>))</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&#x27;计算吃肉结果失败3&#x27;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="comment"># meats= 0</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;计算吃肉结果失败&#x27;</span>)</span><br><span class="line">            tryeatcount += <span class="number">1</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;吃肉结果未知&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># cookie = login()</span></span><br><span class="line">    <span class="comment"># url = yaohuo + &#x27;/bbs/book_list.aspx?action=new&amp;siteid=1000&amp;classid=0&amp;getTotal=2002&amp;page=&#x27;</span></span><br><span class="line">    url = <span class="string">&#x27;/bbs/book_list.aspx?action=new&amp;siteid=1000&amp;classid=0&amp;getTotal=2023&amp;page=&#x27;</span></span><br><span class="line">    maincount = <span class="number">1</span>       <span class="comment">#查询次数</span></span><br><span class="line">    var = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> var == <span class="number">1</span> :  <span class="comment"># 表达式永远为 true</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            netconn = http.client.HTTPSConnection(<span class="string">&quot;yaohuo.me&quot;</span>)</span><br><span class="line">            <span class="comment"># 刷新间隔，单位 秒</span></span><br><span class="line">            refreshInterval=<span class="number">60</span> + random.randint(-<span class="number">40</span>, <span class="number">55</span>)</span><br><span class="line">            <span class="comment"># localtime = time.asctime( time.localtime(time.time()) )</span></span><br><span class="line">            d1 = datetime.datetime.now()</span><br><span class="line">            localtime=<span class="built_in">str</span>(d1)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;-------------第&#x27;</span>+<span class="built_in">str</span>(maincount)+<span class="string">&#x27;次查询，累积吃肉：&#x27;</span>+<span class="built_in">str</span>(meats)+<span class="string">&#x27;,开始时间：&#x27;</span>+localtime+<span class="string">&#x27;---------------&#x27;</span>)</span><br><span class="line">            subcount=counts</span><br><span class="line">            <span class="keyword">while</span> subcount != <span class="number">0</span>:</span><br><span class="line">                <span class="comment"># print(&#x27;||||||||||||||||||||||||||||&#x27;)</span></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;------第&#x27;</span>+<span class="built_in">str</span>(subcount)+<span class="string">&#x27;页----------&#x27;</span>)</span><br><span class="line">                craw(url + <span class="built_in">str</span>(subcount),netconn)</span><br><span class="line">                subcount -= <span class="number">1</span></span><br><span class="line">            netconn.close()</span><br><span class="line">            errorInterval=<span class="number">0</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            errorInterval=errorInterval+random.randint(<span class="number">120</span>, <span class="number">600</span>)</span><br><span class="line">            d3 = d1 + datetime.timedelta(seconds=errorInterval)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;出错，等待&#x27;</span> + <span class="built_in">str</span>(errorInterval) + <span class="string">&#x27;s后继续,下次执行时间：&#x27;</span>+<span class="built_in">str</span>(d3))</span><br><span class="line">            time.sleep(errorInterval)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># netconn = http.client.HTTPSConnection(&quot;yaohuo.me&quot;)</span></span><br><span class="line">        <span class="comment"># for result in sql_traversal():</span></span><br><span class="line">        <span class="comment">#     t = time.time() - float(result[3])</span></span><br><span class="line">        <span class="comment">#     # print(t)#距离上次吃肉时间 86400=24小时</span></span><br><span class="line">        <span class="comment">#     if t &gt; 86400:</span></span><br><span class="line">        <span class="comment">#         netconn.request(&quot;GET&quot;, yaohuo+result[2], payload, headers)</span></span><br><span class="line">        <span class="comment">#         res = netconn.getresponse()</span></span><br><span class="line">        <span class="comment">#         r = res.read().decode(&quot;utf-8&quot;)</span></span><br><span class="line">        <span class="comment">#         detailtext= BeautifulSoup(r, &#x27;html.parser&#x27;).text</span></span><br><span class="line">        <span class="comment">#         # &#x27;余0&#x27; not in detailtext</span></span><br><span class="line">        <span class="comment">#         # r = requests.get(result[2], cookies=cookie).content.decode(&#x27;utf-8&#x27;)</span></span><br><span class="line">        <span class="comment">#         # if (r.find(&#x27;余0&#x27;)) == -1 or (r.find(&#x27;没有权限&#x27;)) == -1 or (r.find(&#x27;结束原因:&#x27;)) == -1:</span></span><br><span class="line">        <span class="comment">#         # searchObj = re.search( r&#x27;(余0\d)&#123;1,&#125;&#x27;, detailtext, re.M|re.I)</span></span><br><span class="line">        <span class="comment">#         # if searchObj:</span></span><br><span class="line">        <span class="comment">#         if (re.search( r&#x27;(余[0-9]&#123;0,&#125;[1-9]&#123;1,&#125;)&#x27;, detailtext, re.M|re.I)) or  (&#x27;没有权限&#x27; not in detailtext) or (&#x27;结束原因:&#x27; not in detailtext) :</span></span><br><span class="line">        <span class="comment">#             eat(result[0], result[1],netconn)</span></span><br><span class="line">        <span class="comment">#             sql_update(result[0])</span></span><br><span class="line">        <span class="comment">#         else:</span></span><br><span class="line">        <span class="comment">#             sql_del(result[0])</span></span><br><span class="line">        </span><br><span class="line">        netconn.close()</span><br><span class="line">        maincount += <span class="number">1</span></span><br><span class="line">        d1 = datetime.datetime.now() + datetime.timedelta(seconds=refreshInterval)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;等待&#x27;</span> + <span class="built_in">str</span>(refreshInterval) + <span class="string">&#x27;s后继续,下次执行时间：&#x27;</span>+<span class="built_in">str</span>(d1))</span><br><span class="line">        time.sleep(refreshInterval)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">#再次吃肉</span></span><br><span class="line">    <span class="comment"># for result in sql_traversal():</span></span><br><span class="line">    <span class="comment">#     t = time.time() - float(result[3])</span></span><br><span class="line">    <span class="comment">#     print(t)#距离上次吃肉时间 86400=24小时</span></span><br><span class="line">    <span class="comment">#     if t &gt; 86400:</span></span><br><span class="line">    <span class="comment">#         r = requests.get(result[2], cookies=cookie).content.decode(&#x27;utf-8&#x27;)</span></span><br><span class="line">    <span class="comment">#         if (r.find(&#x27;余0&#x27;)) == -1 or (r.find(&#x27;没有权限&#x27;)) == -1 or (r.find(&#x27;结束原因:&#x27;)) == -1:</span></span><br><span class="line">    <span class="comment">#             eat(result[0], result[1])</span></span><br><span class="line">    <span class="comment">#             sql_update(result[0])</span></span><br><span class="line">    <span class="comment">#         else:</span></span><br><span class="line">    <span class="comment">#             sql_del(result[0])</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Coding</category>
      </categories>
      <tags>
        <tag>python 妖火</tag>
      </tags>
  </entry>
  <entry>
    <title>基于pve的nas主机</title>
    <url>/2023/05/841c939be235.html</url>
    <content><![CDATA[<p>以前一直用淘汰的j1900当nas，需求就是存点东西外加离线下载，也够用。<br>上个月发现了es处理器和精粤主板，感觉好便宜啊，于是就上车了。第一次搞组装机。</p>
<p>配置列表</p>
<figure class="highlight text"><table><tr><td class="code"><pre><span class="line">精粤b760m-gaming</span><br><span class="line">12代es处理器qygc，据说是i5-12400的测试版，但是实际达不到正式版的性能。</span><br><span class="line">金百达黑爵intel专用条 16g*2</span><br><span class="line">ax90se散热器</span><br><span class="line">m2转4*sata，直通给omv使用</span><br><span class="line">atx全塔机箱，12盘位</span><br><span class="line">鑫谷gp600t白金电源</span><br></pre></td></tr></table></figure>


<p>系统用的pve，考虑到虚拟化的性能，尽量使用lxc。<br>安装lxc版的openwrt装zerotier，在外一键连接家中局域网。<br>安装lxc版的alpine装docker，跑点下载文件以外的服务。<br>安装kvm版omv,直通sata控制器，当作nas，提供smb,nfs,rsync等方式来共享文件，并安装docker跑aria2下载文件。<br>还用虚拟机安装了黑群晖，半洗白，在pve中虚拟一个硬盘给家里人存照片用，定时使用rsync同步至omv中，防止群晖挂了数据读不了。（准备单独整一个，分离出来）</p>
<p>目前发现有些问题，但是毕竟全是丐版配件，便宜嘛，能接受。<br>虚拟机win11，添加开了sriov的核显uhd770，挂机几个小时就会导致pve死机，也不常用。</p>
<p>这么一套搞下来，机械硬盘不读写就半小时休眠，其他操作在固态里，很静音。<br>测了下，烤机时满载100w过点。<br>日常待机时机械硬盘休眠，总功耗二十多瓦。</p>
<p>20230801更新<br>之前因为死机，win虚拟机随用随关，这个月发现12代es使用pve不死机了，可能是内核更新了？<br>搞了张p106矿卡74块包邮，感觉还可以。直通（以后有空再搞vgpu）给win虚拟机使用，用parsec串流玩游戏，目前待机功耗35w的样子（两块机械盘休眠）。</p>
]]></content>
      <categories>
        <category>记事</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>nas</tag>
        <tag>pve</tag>
        <tag>黑群</tag>
      </tags>
  </entry>
  <entry>
    <title>motorola edge s 固定网关ip</title>
    <url>/2022/10/2df294638978.html</url>
    <content><![CDATA[<p>源项目作者对原理的分析<br><a href="https://blog.xhyeax.com/2021/12/06/android-10-11-hostpot-set-ip/">https://blog.xhyeax.com/2021/12/06/android-10-11-hostpot-set-ip/</a><br>通过对原项目代码的查看，发现实现功能的函数在app&#x2F;src&#x2F;main&#x2F;java&#x2F;com&#x2F;xhy&#x2F;xp&#x2F;softaphelper&#x2F;MainHook.java中。<br>开启打印日志，在lsposed中发现是包名没有hook到，包名匹配不正确。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">pkgNameSet.add(<span class="string">&quot;com.android.networkstack.tethering.inprocess&quot;</span>);</span><br><span class="line">pkgNameSet.add(<span class="string">&quot;com.android.networkstack.tethering&quot;</span>);</span><br></pre></td></tr></table></figure>



<p>增加了正确的包名</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">pkgNameSet.add(<span class="string">&quot;com.android.networkstack.tethering.inprocess&quot;</span>);</span><br><span class="line">pkgNameSet.add(<span class="string">&quot;com.android.networkstack.tethering&quot;</span>);</span><br><span class="line">pkgNameSet.add(<span class="string">&quot;com.google.android.networkstack.tethering.inprocess&quot;</span>);</span><br><span class="line">pkgNameSet.add(<span class="string">&quot;com.google.android.networkstack.tethering&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>提取目标手机中TetheringGoogle.apk，使用jadx对TetheringGoogle反编译。<br>发现原requestIpv4Address()方法中无参数的传入，<br>目标手机的requestIpv4Address(boolean z)有参数的传入<br>源IpServer.java#645</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> LinkAddress <span class="title function_">requestIpv4Address</span><span class="params">()</span></span><br></pre></td></tr></table></figure>

<p>motorola edge s的IpServer.java#655</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> LinkAddress <span class="title function_">requestIpv4Address</span><span class="params">(<span class="type">boolean</span> z)</span></span><br></pre></td></tr></table></figure>

<p>修改部分代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">            findAndHookMethod(className, classLoader, methodName, <span class="type">boolean</span>.class,</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">XC_MethodHook</span>() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">beforeHookedMethod</span><span class="params">(XC_MethodHook.MethodHookParam param)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">                            <span class="built_in">super</span>.beforeHookedMethod(param);</span><br><span class="line"><span class="comment">//                            XposedBridge.log(StackUtils.getStackTraceString());</span></span><br><span class="line">                            <span class="keyword">if</span> (StackUtils.isCallingFrom(className, callerMethodName_Q)) &#123;</span><br><span class="line">                                param.setResult(mLinkAddress);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>后通过参考实现LSPosed的作用域的自动勾选<br><a href="https://blog.csdn.net/niubitianping/article/details/117668651">https://blog.csdn.net/niubitianping/article/details/117668651</a></p>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>arch</tag>
        <tag>android</tag>
        <tag>JAVA</tag>
      </tags>
  </entry>
  <entry>
    <title>通过python对爱奇艺犯罪电影的爬取</title>
    <url>/2022/10/75b1329e4902.html</url>
    <content><![CDATA[<p>听到同学说他们的python的期末作业是使用python对爱奇艺的犯罪电影信息进行爬取，并生成excel，尝试了下<br>2019年尝试的。<br><a href="https://github.com/dsfgdadg/iqiyi_spider">https://github.com/dsfgdadg/iqiyi_spider</a></p>
]]></content>
      <categories>
        <category>Coding</category>
      </categories>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian下hexo安装记录</title>
    <url>/2022/10/b0490f303124.html</url>
    <content><![CDATA[<p>安装  Node.js LTS<br><a href="https://github.com/nodesource/distributions#debinstall">https://github.com/nodesource/distributions#debinstall</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">curl -fsSL https://deb.nodesource.com/setup_lts.x | bash - &amp;&amp;\</span><br><span class="line">apt-get install -y nodejs</span><br></pre></td></tr></table></figure>


<p>安装hexo，参照<br><a href="https://hexo.io/zh-cn/docs/">https://hexo.io/zh-cn/docs/</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br><span class="line">mkdir hexo</span><br><span class="line">cd hexo</span><br><span class="line">hexo init</span><br></pre></td></tr></table></figure>

<p>安装next主题<br><a href="https://github.com/next-theme/hexo-theme-next">https://github.com/next-theme/hexo-theme-next</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/next-theme/hexo-theme-next themes/next</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>添加字数统计<br>修改hexo配置文件以及next主题配置文件<br><a href="https://github.com/next-theme/hexo-word-counter">https://github.com/next-theme/hexo-word-counter</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-word-counter --save</span><br><span class="line">hexo clean</span><br></pre></td></tr></table></figure>

<p>添加搜索<br><a href="http://theme-next.iissnan.com/third-party-services.html#search-system">http://theme-next.iissnan.com/third-party-services.html#search-system</a><br><a href="https://hexo-next.readthedocs.io/zh_CN/latest/next/advanced/%E6%90%9C%E7%B4%A2%E6%9C%8D%E5%8A%A1/">https://hexo-next.readthedocs.io/zh_CN/latest/next/advanced/%E6%90%9C%E7%B4%A2%E6%9C%8D%E5%8A%A1/</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>阅读全文<br>官方文档中提到的auto_excerpt在新版本中取消了<br><a href="http://theme-next.iissnan.com/faqs.html#read-more">http://theme-next.iissnan.com/faqs.html#read-more</a><br>故改用<br><a href="https://github.com/chekun/hexo-excerpt">https://github.com/chekun/hexo-excerpt</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-excerpt --save</span><br></pre></td></tr></table></figure>

<p>文章加密插件<br><a href="https://github.com/D0n9X1n/hexo-blog-encrypt/blob/master/ReadMe.zh.md">https://github.com/D0n9X1n/hexo-blog-encrypt/blob/master/ReadMe.zh.md</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-blog-encrypt</span><br></pre></td></tr></table></figure>


<p>文章置顶<br><a href="https://github.com/hexojs/hexo-generator-index">https://github.com/hexojs/hexo-generator-index</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-index --save</span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/netcan/hexo-generator-index-pin-top">https://github.com/netcan/hexo-generator-index-pin-top</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm uninstall hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-index-pin-top --save</span><br></pre></td></tr></table></figure>


<p>部署到github<br><a href="https://github.com/hexojs/hexo-generator-index">https://github.com/hexojs/hexo-generator-index</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>


<p>生成博客内容</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g -d</span><br></pre></td></tr></table></figure>

<p>github 自定义域名<br>自定义域名xxx.xx，个人用户名ppp<br>添加cname记录xxx.xx指向ppp.github.io<br>在项目的settings页面中的pages，填入xxx.xx。</p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>debian</tag>
      </tags>
  </entry>
  <entry>
    <title>通过Docker安装nas上常用的服务</title>
    <url>/2022/02/4596d83990e1.html</url>
    <content><![CDATA[<h2 id="portainer-docker管理面板"><a href="#portainer-docker管理面板" class="headerlink" title="portainer docker管理面板"></a>portainer docker管理面板</h2><p><a href="https://github.com/tbc0309/Portainer-CN2021">https://github.com/tbc0309/Portainer-CN2021</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d --restart=always --name=&quot;portainer&quot; \</span><br><span class="line">-p 9000:9000 \</span><br><span class="line">-v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">-v /usr/docker/portainer_data:/data \</span><br><span class="line">6053537/portainer-ce</span><br></pre></td></tr></table></figure>


<h2 id="PrivateBin-在线-私人-剪切板"><a href="#PrivateBin-在线-私人-剪切板" class="headerlink" title="PrivateBin 在线 私人 剪切板"></a>PrivateBin 在线 私人 剪切板</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker run -d --restart=<span class="string">&quot;always&quot;</span> --name=privatebin --read-only \</span><br><span class="line">-p 50013:8080 \</span><br><span class="line">-v /usr/docker/privatebin/data:/srv/data \</span><br><span class="line">privatebin/nginx-fpm-alpine</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="qiandao-签到面板"><a href="#qiandao-签到面板" class="headerlink" title="qiandao 签到面板"></a>qiandao 签到面板</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">docker <span class="built_in">rm</span> -f qiandao</span><br><span class="line">docker run -d --name qiandao \</span><br><span class="line">-p 50001:80 \</span><br><span class="line">-v /usr/docker/qiandao/config:/usr/src/app/config \</span><br><span class="line">a76yyyy/qiandao</span><br></pre></td></tr></table></figure>

<h2 id="flare-web导航页"><a href="#flare-web导航页" class="headerlink" title="flare web导航页"></a>flare web导航页</h2><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run --name flare -d -p 50005:5005 -v /usr/docker/flare/app:/app soulteary/flare</span><br></pre></td></tr></table></figure>

<h2 id="aria2-pro-下载工具"><a href="#aria2-pro-下载工具" class="headerlink" title="aria2-pro 下载工具"></a>aria2-pro 下载工具</h2><p><a href="https://github.com/P3TERX/Aria2-Pro-Docker">https://github.com/P3TERX/Aria2-Pro-Docker</a></p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">    --name aria2-pro \</span><br><span class="line">    --restart unless-stopped \</span><br><span class="line">    --log-opt max-size=1m \</span><br><span class="line">    --network host \</span><br><span class="line">    -e PUID=$UID \</span><br><span class="line">    -e PGID=$GID \</span><br><span class="line">    -e RPC_SECRET=aria2的rpc_token \</span><br><span class="line">    -e RPC_PORT=6800 \</span><br><span class="line">    -e LISTEN_PORT=56801 \</span><br><span class="line">    -v /usr/docker/aria2-pro1/config:/config \</span><br><span class="line">    -v /usr/docker/aria2-pro1/downloads:/downloads \</span><br><span class="line">    p3terx/aria2-pro</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="通过watchtower配置自动更新容器"><a href="#通过watchtower配置自动更新容器" class="headerlink" title="通过watchtower配置自动更新容器"></a>通过watchtower配置自动更新容器</h2><p><a href="https://www.likecs.com/show-205274611.html">https://www.likecs.com/show-205274611.html</a><br>更新指定容器</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run -d \</span><br><span class="line">    --name watchtower \</span><br><span class="line">    --restart unless-stopped \</span><br><span class="line">    -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">    containrrr/watchtower \</span><br><span class="line">    -c aria2-pro privatebin</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="手动更新完成后删掉本次运行创建的-Watch­tower-容器"><a href="#手动更新完成后删掉本次运行创建的-Watch­tower-容器" class="headerlink" title="手动更新完成后删掉本次运行创建的 Watch­tower 容器"></a>手动更新完成后删掉本次运行创建的 Watch­tower 容器</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">docker run --rm \</span><br><span class="line">    -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">    containrrr/watchtower -c \</span><br><span class="line">    --run-once \</span><br><span class="line">    aria2-pro</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>debian</tag>
        <tag>vps</tag>
        <tag>nas</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian下docker的安装</title>
    <url>/2022/02/91a475d75bdd.html</url>
    <content><![CDATA[<p>准备工作</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get remove -y docker docker-engine docker.io</span><br><span class="line">sudo apt-get install -y apt-transport-https ca-certificates curl gnupg2 software-properties-common</span><br><span class="line">curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add -</span><br><span class="line">sudo add-apt-repository \</span><br><span class="line">   &quot;deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/debian \</span><br><span class="line"><span class="meta prompt_">   $</span><span class="language-bash">(lsb_release -cs) \</span></span><br><span class="line"><span class="language-bash">   stable<span class="string">&quot;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>docker的安装</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt-get update -y</span><br><span class="line">sudo apt-get install -y docker-ce</span><br><span class="line">sudo mkdir -p /etc/docker</span><br><span class="line">sudo tee /etc/docker/daemon.json &lt;&lt;EOF</span><br><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://ustc-edu-cn.mirror.aliyuncs.com/&quot;,</span><br><span class="line">        &quot;https://hub-mirror.c.163.com/&quot;</span><br><span class="line">    ],</span><br><span class="line">    &quot;dns&quot;: [&quot;127.0.0.1&quot;, &quot;8.8.8.8&quot;]</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">sudo systemctl enable docker</span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br><span class="line">sudo groupadd docker</span><br><span class="line">sudo usermod -aG docker $USER</span><br><span class="line">newgrp docker</span><br></pre></td></tr></table></figure>

<p>安装docker-compose</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo curl -L https://github.com/docker/compose/releases/download/v2.3.3/docker-compose-linux-`uname -m` &gt; ./docker-compose</span><br><span class="line">sudo chmod +x ./docker-compose</span><br><span class="line">sudo mv ./docker-compose /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>docker</tag>
        <tag>debian</tag>
        <tag>vps</tag>
        <tag>nas</tag>
      </tags>
  </entry>
  <entry>
    <title>systemd常见问题</title>
    <url>/2022/02/0e077e77da44.html</url>
    <content><![CDATA[<p>为了节省资源，开机之后不想让系统启动图形界面。想就停在控制台的文字界面就可以。<br>于是乎：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl set-default multi-user.target</span><br></pre></td></tr></table></figure>

<p>如果想重新启动自动进入图形界面的话就：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl set-default graphical.target</span><br></pre></td></tr></table></figure>

<p>把启动顺序及用时信息存成svg格式图表，一目了然</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemd-analyze plot &gt; ~/Desktop/boot.svg</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/harry_wang0/article/details/108190385">https://blog.csdn.net/harry_wang0/article/details/108190385</a></p>
<p>列出所有加载失败的 Unit</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systemctl list-units –failed</span><br><span class="line">systemctl –failed</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>debian</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian下防火墙的配置</title>
    <url>/2022/02/0fd70fba5e2e.html</url>
    <content><![CDATA[<p><strong>1、安装</strong></p>
<p>在root权限下执行命令行安装。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo apt update</span><br><span class="line">sudo apt install fail2ban firewalld</span><br></pre></td></tr></table></figure>


<p><strong>2、配置</strong><br>2.1 <em><strong>Fail2ban 的配置</strong></em><br>参考<br><a href="https://www.cnblogs.com/tanger/p/14868501.html">https://www.cnblogs.com/tanger/p/14868501.html</a></p>
<p>2.2 <em><strong>Firewalld 的配置</strong></em><br>其中对网络区域zones的理解讲的很通俗易懂<br><a href="https://blog.csdn.net/weixin_45776100/article/details/123081660">https://blog.csdn.net/weixin_45776100/article/details/123081660</a><br>每次修改完后记得重新加载一下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure>

<p><strong>3、附加：iptables</strong><br><a href="https://www.zsythink.net/archives/category/%e8%bf%90%e7%bb%b4%e7%9b%b8%e5%85%b3/iptables">https://www.zsythink.net/archives/category/%e8%bf%90%e7%bb%b4%e7%9b%b8%e5%85%b3/iptables</a></p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>debian</tag>
        <tag>fail2ban</tag>
        <tag>firewalld</tag>
      </tags>
  </entry>
  <entry>
    <title>为红米note4x编译crdroid</title>
    <url>/2021/07/78cdf5024a13.html</url>
    <content><![CDATA[<p>为红米note4x编译kernel并增加docker的支持</p>
<p><a href="https://www.erickbuilds.tech/2021/07/crdroid-official-build-for-xiaomi-redmi.html">https://www.erickbuilds.tech/2021/07/crdroid-official-build-for-xiaomi-redmi.html</a></p>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>arch</tag>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>archlinux下搭建安卓开发环境</title>
    <url>/2021/07/c5e3ce531153.html</url>
    <content><![CDATA[<p><a href="https://wiki.archlinux.org/title/Android">https://wiki.archlinux.org/title/Android</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">paru -S  aosp-devel lineageos-devel</span><br></pre></td></tr></table></figure>


<p>sdk</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">paru -S android-sdk-cmdline-tools-latest android-sdk-build-tools android-sdk-platform-tools android-platform</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>arch</tag>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>Archlinux的安装</title>
    <url>/2021/01/f766ba1a3491.html</url>
    <content><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>使用archlinux作为主力系统也有两年了，只有一次更新后因为部分依赖没有更新导致出现问题，系统无法启动，其它都挺好的。<br>使用kde桌面，用kdeconnect来实现多平台同步剪切板这个功能很不错，<br>许多github上的开源应用都可以在软件源中找到，使用paru安装即可。<br>担心系统滚挂可以使用timemachine进行备份。</p>
<h2 id="安装及使用"><a href="#安装及使用" class="headerlink" title="安装及使用"></a>安装及使用</h2><p>安装以及使用教程网上很多，常见的问题都可以在网上找到。遇到问题多阅读wiki，还有官方论坛。善用搜索。</p>
<h2 id="参考以下链接"><a href="#参考以下链接" class="headerlink" title="参考以下链接"></a>参考以下链接</h2><p><a href="https://archlinuxstudio.github.io/ArchLinuxTutorial/#/rookie/basic_install">https://archlinuxstudio.github.io/ArchLinuxTutorial/#/rookie/basic_install</a><br><a href="https://wiki.archlinux.org/title/Installation_guide">https://wiki.archlinux.org/title/Installation_guide</a></p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>arch</tag>
      </tags>
  </entry>
  <entry>
    <title>Linux开启swap的方法</title>
    <url>/2019/09/27cd423710c2.html</url>
    <content><![CDATA[<p>Linux中Swap（即：交换分区），类似于Windows的虚拟内存，就是当内存不足的时候，把一部分硬盘空间虚拟成内存使用,从而解决内存容量不足的情况。</p>
<p> 交换分区，英文的说法是swap，意思是“交换”、“实物交易”。它的功能就是在内存不够的情况下，操作系统先把内存中暂时不用的数据，存到硬盘的交换空间，腾出内存来让别的程序运行，和Windows的虚拟内存（pagefile.sys）的作用是一样的。</p>
<p>查看</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">free -m</span><br></pre></td></tr></table></figure>


<p>可以看到swap大小为0！执行如下：</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd /var/</span><br><span class="line">dd if=/dev/zero of=swapfile bs=1024 count=1048576 #创建大小为1G的文件swapfile</span><br><span class="line">mkswap swapfile #格式化虚拟内存文件</span><br><span class="line">swapon swapfile #激活虚拟内存文件</span><br></pre></td></tr></table></figure>



<p>再编辑自动挂载文件，让系统开机的时候自动加载虚拟内存文件，将下面的内容复制&#x2F;粘贴，然后按Esc键，输入:x保存并退出！</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi /etc/fstab</span><br></pre></td></tr></table></figure>



<p>添加：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/var/swapfile swap swap defaults 0 0</span><br></pre></td></tr></table></figure>



<p>或者懒得VI，直接：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo ‘/var/swapfile swap swap defaults 0 0 ‘ &gt;&gt; /etc/fstab</span><br></pre></td></tr></table></figure>



<p>查看fstab：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cat /etc/fstab</span><br></pre></td></tr></table></figure>


<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">free -m查看</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>debian</tag>
      </tags>
  </entry>
  <entry>
    <title>debian目录默认中文</title>
    <url>/2019/09/761cc4fff0e1.html</url>
    <content><![CDATA[<p>目录彩色</p>
<p>vi ~&#x2F;.bashrc</p>
<p>alias ls&#x3D;’ls –color’</p>
<p>source ~&#x2F;.bashrc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apt-get install locales</span><br><span class="line">dpkg-reconfigure locales</span><br></pre></td></tr></table></figure>




<p>目录英文改中文<br>1.修改~&#x2F;.config&#x2F;user-dirs.dirs这个配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vi ~/.config/user-dirs.dirs</span><br></pre></td></tr></table></figure>



<p>中文版的配置文件是这样的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># This file is written by xdg-user-dirs-update</span><br><span class="line"># If you want to change or add directories, just edit the line you&#x27;re</span><br><span class="line"># interested in. All local changes will be retained on the next run</span><br><span class="line"># Format is XDG_xxx_DIR=&quot;$HOME/yyy&quot;, where yyy is a shell-escaped</span><br><span class="line"># homedir-relative path, or XDG_xxx_DIR=&quot;/yyy&quot;, where /yyy is an</span><br><span class="line"># absolute path. No other format is supported.</span><br><span class="line"># </span><br><span class="line">XDG_DESKTOP_DIR=&quot;$HOME/桌面&quot;</span><br><span class="line">XDG_DOWNLOAD_DIR=&quot;$HOME/下载&quot;</span><br><span class="line">XDG_TEMPLATES_DIR=&quot;$HOME/模板&quot;</span><br><span class="line">XDG_PUBLICSHARE_DIR=&quot;$HOME/公共&quot;</span><br><span class="line">XDG_DOCUMENTS_DIR=&quot;$HOME/文档&quot;</span><br><span class="line">XDG_MUSIC_DIR=&quot;$HOME/音乐&quot;</span><br><span class="line">XDG_PICTURES_DIR=&quot;$HOME/图片&quot;</span><br><span class="line">XDG_VIDEOS_DIR=&quot;$HOME/视频&quot;</span><br></pre></td></tr></table></figure>


<p>修改后的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># This file is written by xdg-user-dirs-update</span><br><span class="line"># If you want to change or add directories, just edit the line you&#x27;re</span><br><span class="line"># interested in. All local changes will be retained on the next run</span><br><span class="line"># Format is XDG_xxx_DIR=&quot;$HOME/yyy&quot;, where yyy is a shell-escaped</span><br><span class="line"># homedir-relative path, or XDG_xxx_DIR=&quot;/yyy&quot;, where /yyy is an</span><br><span class="line"># absolute path. No other format is supported.</span><br><span class="line"># </span><br><span class="line">XDG_DESKTOP_DIR=&quot;$HOME/Desktop&quot;</span><br><span class="line">XDG_DOWNLOAD_DIR=&quot;$HOME/Downloads&quot;</span><br><span class="line">XDG_TEMPLATES_DIR=&quot;$HOME/Templates&quot;</span><br><span class="line">XDG_PUBLICSHARE_DIR=&quot;$HOME/Public&quot;</span><br><span class="line">XDG_DOCUMENTS_DIR=&quot;$HOME/Documents&quot;</span><br><span class="line">XDG_MUSIC_DIR=&quot;$HOME/Music&quot;</span><br><span class="line">XDG_PICTURES_DIR=&quot;$HOME/Pictures&quot;</span><br><span class="line">XDG_VIDEOS_DIR=&quot;$HOME/Videos&quot;</span><br></pre></td></tr></table></figure>







<p>#安装需要的软件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo apt install xdg-user-dirs-gtk</span><br></pre></td></tr></table></figure>

<p>#临时转换系统语言为英文，重启后会自动恢复原值的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export LANG=en_US</span><br></pre></td></tr></table></figure>

<p>#执行转换命令，弹出的窗口中会询问是否将目录转化为英文路径，同意并关闭</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xdg-user-dirs-gtk-update</span><br></pre></td></tr></table></figure>

<p>#转换回系统语言为中文，也可以不执行下面的命令，直接重启也一样的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">export LANG=zh_CN</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>linux</category>
        <category>debian</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>debian</tag>
      </tags>
  </entry>
  <entry>
    <title>Debian  添加服务自启动</title>
    <url>/2019/08/4898dc444f70.html</url>
    <content><![CDATA[<p><strong>xxx为服务名称</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/etc/init.d/xxx</span><br><span class="line">update-rc.d xxx defaults</span><br><span class="line">service xxx status</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>debian</tag>
        <tag>vps</tag>
      </tags>
  </entry>
  <entry>
    <title> 红米NOTE4X SYSTEM只读改读写 </title>
    <url>/2019/08/852e786ac142.html</url>
    <content><![CDATA[<p>切换Root用户执行以下命令</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">mount -o rw,remount -t ext4 /dev/block/platform/soc/7824900.sdhci/by-name/system /system</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>安卓</tag>
        <tag>玩机</tag>
      </tags>
  </entry>
</search>
